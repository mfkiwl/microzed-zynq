#!/usr/bin/env sh

# A_R: part a right side
# GAP: not real pin, only gap between pins
declare -A PARTS
PARTS=(
	[A_R]='G12 G11 H13 G14 GAP T10 T8 T7 G10 GAP T12 T11 T14 GAP N12 N11 GAP L11 M12 GAP T13'
	[B_R]='R7 U7 V9 V10 W8 V8 W10 W11 W12 V12 U11 U12 U9 U10 AB12 AA12 AB11 AA11 AB9 AB10 Y10 Y11 AA8 AA9 Y8 Y9 Y5 Y6 AA6 AA7 AB1 AB2 AB4 AB5 AB6 AB7 AA4 Y4 T6 R6 U4 T4 V4 V5 U5 U6 W7 V7 W5 W6'
	[C_R]='U19 U14 U21 T21 U22 T22 W22 V22 W21 W20 V20 U20 V19 V18 AB22 AA22 AB21 AA21 Y21 Y20 AB20 AB19 AA19 Y19 AA18 Y18 W18 W17 Y16 W16 U16 U15 V17 U17 AB17 AA17 AB16 AA16 V15 V14 W13 V13 Y15 W15 AA14 Y14 AA13 Y13 AB15 AB14'
	[D_R]='H15 R15 K15 J15 J17 J16 L16 K16 M17 L17 N18 N17 M16 M15 K18 J18 J22 J21 K21 J20 L22 L21 K20 K19 L19 L18 M20 M19 N20 N19 M22 M21 P22 N22 R21 R20 P21 P20 P15 N15 P18 P17 T17 T16 T19 R19 T18 R18 R16 P16'
	[E_R]='H17 H18 E16 F16 D17 D16 D15 E15 G16 G15 E18 F18 F17 G17 B15 C15 B17 B16 A17 A16 A19 A18 C18 C17 C19 D18 B20 B19 C20 D20 A22 A21 C22 D22 D21 E21 B22 B21 H20 H19 F19 G19 E20 E19 G21 G20 F22 F21 G22 H22'
	[F_L]='G4 F4 H4 G5 J3 H5 J5 J6 J7 K5 K6 L4 K4 M5 M4 GAP M6 L6 L7 GAP R5 P3 P6 R4 GAP F3 GAP V3 N5 N4 GAP P5 GAP M7 N7 GAP H7 P7'
	[F_R]='Y1 W3 Y3 W1 U2 AA1 U1 AA3 R1 M2 T2 R3 T1 N3 T3 M1 K3 J1 K1 L3 L2 L1 G1 G2 F1 F2 E1 E3 D3 B2 C3 D1 GAP B1 H3 P1 AA2 GAP D2 C2 J2 H2 P2 N2 W2 V2'
	[G_R]='F7 B5 GAP G6 A1 A2 F6 E4 A3 A4 D5 E5 C4 G7 B4 C5 A6 B6 E6'
	[H_R]='F8 C9 GAP D6 E9 A7 E10 A8 F11 A14 E11 B7 F12 A13 D7 A12 E8 A11 F9 C7 G13 B12 F14 A9 B14 F13 C13 E14 C8 D8 B11 E13 B9 D12 B10 D11 C14 D13 C10 D10 C12'
	[I_L]='E2 F5 H1 J4 K7 M3 N6 R2 V1 GAP H11 J10 GAP B3 C6 GAP A10 B13 D9 E12 GAP G8 H9 J8 L8 N8 R8 GAP K9 M9 P9 T9 GAP H10 GAP L12 GAP M11'
	[I_R]='AA10 AB3 T5 U8 V11 W4 Y7 GAP AA20 AB13 U18 V21 W14 Y17 GAP K17 L20 N16 P19 R22 T15 GAP A20 C16 D19 E22 F15 G18 H21 GAP J12 J14 K13 L14 M13 N14 P13 R14 GAP L10 N10 P11 R10 GAP R12 GAP K11 GAP G9'
	[J_L]='A5 A15 AA5 AA15 AB8 AB18 B8 B18 C1 C11 C21 D4 D14 E7 E17 F10 F20 G3 H6 H8 H12 H14 H16 J9 J11 J13 J19 K2 K8 K10 K14 K22'
	[J_R]='L5 L9 L13 L15 M8 M10 M14 M18 N1 N9 N13 N21 P4 P8 P10 P12 P14 R9 R11 R13 R17 T20 U3 U13 V6 V16 W9 W19 Y2 Y12 Y22 K12'
)

ord() {
	`printf "%d" "'$1"`
}
chr() {
	OCTSTR="`printf '%03o' $1`"
	RETSTR=`printf "\\\\${OCTSTR}"`
	echo ${RETSTR}
}

STDDIST=-100
SRCFILE="original.txt"
DSTFILE="new.txt"
echo "" > $DSTFILE
DCONT=""

ONESIDE() {
	PARTIDX=$1
	ASCII_V=$(($PARTIDX + 64))
	ASCII_C="$(chr ${ASCII_V})"
	SIDE=$2
	KEY=${ASCII_C}_${SIDE}

	TEXTDIR=$3

	DIMX=$4
	DIMY=$5
	STEPX=$6
	STEPY=$7

	for j in ${PARTS[${KEY}]}; do
		if [ "$j" = "GAP" ]; then
			# SKIP
			DIMX=$(($DIMX + $STEPX))
			DIMY=$(($DIMY + $STEPY))
		else
			CONT=`cat $SRCFILE | grep " $j "`
			#echo "CONT is $CONT"
			ACONT=($CONT)
			ACONT[3]=$DIMX
			ACONT[4]=$DIMY
			ACONT[6]=$TEXTDIR
			ACONT[9]=$PARTIDX
			ACONT[10]=1

			for k in {0..10}; do
				DCONT="${DCONT}${ACONT[$k]} "
			done
			DCONT="${DCONT}${ACONT[11]}\n"

			# move coord
			DIMX=$(($DIMX + $STEPX))
			DIMY=$(($DIMY + $STEPY))
		fi
	done
}


for i in {1..10}; do
	ONESIDE $i L R 0 0 0 -100
	ONESIDE $i R L 800 0 0 -100
	ONESIDE $i U D 0 2000 100 0
	ONESIDE $i D U 0 1000 100 0
done

echo -en "$DCONT" > $DSTFILE

